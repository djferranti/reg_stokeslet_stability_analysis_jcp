function Bxi = BhatXi(c,kx,ky,z,xi,x0,y0)

Bxi = exp(-sqrt(-1).*(kx.*x0+ky.*y0)).* ...
  ((1/8).*c.^(-2).*exp(1).^((-1/4).*c.^2.*xi.^2+(-1).*xi.^(-2).*z.^2) ...
  .*xi.*pi.^(-3/2).*(1 + xi.^2 .* c.^2 ./ 2) ... 
  + (1/16).*c.^(-3).*exp(1).^((-1).*c.*z).*pi.^( ...
  -1).*(1+c.*z).*erfc((1/2).*c.*xi+(-1).*xi.^(-1).*z)+(1/16).* ...
  c.^(-3).*exp(1).^(c.*z).*pi.^(-1).*(1+(-1).*c.*z).*erfc((1/2).*c.* ...
  xi+xi.^(-1).*z));
