function Gxi = GhatXi(c,kx,ky,z,xi,x0,y0)

Gxi = exp(-sqrt(-1).*(kx.*x0+ky.*y0)).*((-1/8).*exp(1).^((-1/4).*c.^2.*xi.^2+(-1).*xi.^(-2).*z.^2).* ...
  xi.^(-1).*pi.^(-3/2) .* (2 .* xi.^2 + 1/2 .* xi.^4 .* c.^2 - 2 .* z.^2)+ ...
  (-1/8).*c.^(-1).*pi.^(-1).*(exp(1).^((-1).*c.*z).* ...
  erfc((1/2).*c.*xi+(-1).*xi.^(-1).*z)+exp(1).^(c.*z).*erfc(( ...
  1/2).*c.*xi+xi.^(-1).*z)));